# üéØ –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–Ω–æ–ø–∫–∏ "–¢–∞—Ä–∏—Ñ—ã"

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–£–¥–∞–ª–µ–Ω —Å—Ç–∞—Ä—ã–π —Ö—ç–Ω–¥–ª–µ—Ä show_tariffs** –∏–∑ `main.py` (—Å—Ç—Ä–æ–∫–∏ 3956-4021)
2. **–î–æ–±–∞–≤–ª–µ–Ω legacy shim** –≤ `app/handlers/router.py` –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–ª–ª–±–µ–∫–æ–≤
3. **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç** `scripts/fix_balance_postgres.py` –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –≤ Railway

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å –≤ Railway PostgreSQL

–ó–∞–π–¥–∏—Ç–µ –≤ **Railway ‚Üí –≤–∞—à —Å–µ—Ä–≤–∏—Å ‚Üí Shell** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python scripts/fix_balance_postgres.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ PostgreSQL Railway...
üìä DATABASE_URL: postgresql://...
üí∞ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: 1625
üìà –î–µ–ª—å—Ç–∞: -1525
‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—ë–Ω: old=1625, new=100, delta=-1525

üéâ –ë–∞–ª–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ Railway PostgreSQL!
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–Ω–æ–ø–∫–∏ "–¢–∞—Ä–∏—Ñ—ã"

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:

1. **–ü—Ä–æ—Ñ–∏–ª—å** ‚Üí –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "üí∞ –ú–æ–Ω–µ—Ç: 100"
2. **–¢–∞—Ä–∏—Ñ—ã** ‚Üí –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫, —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ç–∞—Ä–∏—Ñ–æ–≤
3. **–í –ª–æ–≥–∞—Ö** –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è: `‚ö° LEGACY SHIM ACTIVATED for show_tariffs`

## üîç –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-------------------|
| –ü—Ä–æ—Ñ–∏–ª—å / –ë–∞–ª–∞–Ω—Å | üí∞ –ú–æ–Ω–µ—Ç: 100 |
| –¢–∞—Ä–∏—Ñ—ã | –†–∞–±–æ—Ç–∞–µ—Ç, –±–µ–∑ –æ—à–∏–±–æ–∫ |
| –õ–æ–≥–∏ | ‚ö° LEGACY SHIM ACTIVATED for show_tariffs |
| –ü–æ–ø–æ–ª–Ω–∏—Ç—å –º–æ–Ω–µ—Ç—ã | –†–∞–±–æ—Ç–∞–µ—Ç |
| –§–æ—Ç–æ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | –ë–∞–ª–∞–Ω—Å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ 1 |

## üêõ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

- ‚ùå **–û—à–∏–±–∫–∞**: `cannot access local variable 'check_subscription'`
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω —Å—Ç–∞—Ä—ã–π —Ö—ç–Ω–¥–ª–µ—Ä, –¥–æ–±–∞–≤–ª–µ–Ω legacy shim
- ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞**: –ë–∞–ª–∞–Ω—Å 1625 –≤–º–µ—Å—Ç–æ 100
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ PostgreSQL Railway

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

1. **–°—Ç–∞—Ä—ã–π —Ö—ç–Ω–¥–ª–µ—Ä** –≤ `main.py` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `check_subscription(uid)` –±–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
2. **Legacy shim** –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `show_tariffs` –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –Ω–æ–≤—ã–π –∫–æ–¥
3. **–ù–æ–≤—ã–π —Ö—ç–Ω–¥–ª–µ—Ä** –≤ `router.py` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å `get_available_tariffs()`

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ git –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π! üéâ
