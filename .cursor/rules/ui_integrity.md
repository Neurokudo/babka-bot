# üß≠ UI INTEGRITY POLICY

## üéØ –¶–µ–ª—å
–ó–∞—â–∏—Ç–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –±–æ—Ç–∞ –æ—Ç –ø–æ–ª–æ–º–æ–∫, –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –∫–Ω–æ–ø–æ–∫.

---

## üîç –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ Cursor –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ UI:

### 1. Callback-–¥–∞–Ω–Ω—ã–µ
- –í—Å–µ `callback_data` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **—É–Ω–∏–∫–∞–ª—å–Ω—ã** –ø–æ –≤—Å–µ–º—É –ø—Ä–æ–µ–∫—Ç—É.  
- –õ—é–±–æ–π `callback_data` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `CallbackQueryHandler` –∏–ª–∏ –≤ `app/ui/router.py`.  
- Cursor –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å, –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç:
  - –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è callback-—Å—Ç—Ä–æ–∫–∏;
  - Callback –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞;
  - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –±–µ–∑ –∫–Ω–æ–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

### 2. –ö–Ω–æ–ø–∫–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã
- –ö–∞–∂–¥–∞—è –∫–Ω–æ–ø–∫–∞ –≤ `InlineKeyboardMarkup` –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å:
  - –¢–µ–∫—Å—Ç (caption)
  - Callback –∏–ª–∏ URL  
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–Ω–æ–ø–æ–∫ Cursor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
  - –ß—Ç–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥ –∏–ª–∏ –æ—Ç–≤–µ—Ç (`answer_callback_query`);
  - –ß—Ç–æ –Ω–µ—Ç "–º–µ—Ä—Ç–≤—ã—Ö" —Å–æ—Å—Ç–æ—è–Ω–∏–π (—ç–∫—Ä–∞–Ω–æ–≤ –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞);
  - –ß—Ç–æ –Ω–µ—Ç –∫–Ω–æ–ø–æ–∫, –≤–µ–¥—É—â–∏—Ö –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º callback'–∞–º.

### 3. –ú–µ–Ω—é –∏ –º–∞—Ä—à—Ä—É—Ç—ã
- –í –∫–∞–∂–¥–æ–º —Ä–∞–∑–¥–µ–ª–µ (`–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é`, `–û–ø–ª–∞—Ç–∞`, `–ü—Ä–æ—Ñ–∏–ª—å`, `–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–µ—Ä–æ—á–Ω–∞—è`) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω—å—à–µ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –∏–ª–∏ "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é".
- –í—Å–µ –ø—É—Ç–∏ (`start`, `back`, `home`) –¥–æ–ª–∂–Ω—ã –≤—ã–∑—ã–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `handlers/menu.py`.

---

## üö® Cursor –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å:
- "‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ callback_data: tryon_start –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ –¥–≤—É—Ö —Ä–∞–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö."
- "‚ùå –ö–Ω–æ–ø–∫–∞ '–û–ø–ª–∞—Ç–∏—Ç—å' –Ω–µ –∏–º–µ–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ callback_query."
- "‚ö†Ô∏è –≠–∫—Ä–∞–Ω '–¢–∞—Ä–∏—Ñ—ã' –Ω–µ –∏–º–µ–µ—Ç –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞."
- "‚ö†Ô∏è Callback 'profile_menu' —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π handler."

---

## üß© –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π self-test UI
Cursor –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:
```bash
python scripts/test_ui_routes.py
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞:
- –ü—Ä–æ–π—Ç–∏ –ø–æ –≤—Å–µ–º –∫–Ω–æ–ø–∫–∞–º –≤ ui/menus.py
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ callback-—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ handlers/
- –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ "–±–∏—Ç—ã—Ö" –ø–µ—Ä–µ—Ö–æ–¥–æ–≤.

## ‚úÖ –ò—Ç–æ–≥
–ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ø–ª–æ–µ–º Cursor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –∏ callback'–æ–≤;
- –ù–∞–ª–∏—á–∏–µ "–ù–∞–∑–∞–¥/–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é" –≤ –∫–∞–∂–¥–æ–º –º–µ–Ω—é;
- –†–∞–±–æ—Ç—É –∫–ª—é—á–µ–≤—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ ("–¢–∞—Ä–∏—Ñ—ã", "–ü—Ä–æ—Ñ–∏–ª—å", "–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–µ—Ä–æ—á–Ω–∞—è", "–°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ");
- –ß—Ç–æ –Ω–∏ –æ–¥–∏–Ω callback –Ω–µ –≤–µ–¥—ë—Ç –≤ –Ω–∏–∫—É–¥–∞.

## üîç –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ Cursor –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å UI-–ø—Ä–æ–≤–µ—Ä–∫–∏:

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã UI
- `main.py` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- `app/ui/keyboards.py` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ –∫–Ω–æ–ø–∫–∏
- `app/ui/callbacks.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback'–æ–≤
- `app/ui/menu_schema.py` - —Å—Ö–µ–º–∞ –º–µ–Ω—é
- `app/handlers/router.py` - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ `kb_*()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `on_cb` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ `cmd_*` - –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ `on_*` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

## üß™ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã UI

### 1. –¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ callback'–æ–≤
```python
def test_callback_uniqueness():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ callback_data —É–Ω–∏–∫–∞–ª—å–Ω—ã
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫
```

### 2. –¢–µ—Å—Ç –Ω–∞–ª–∏—á–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
```python
def test_callback_handlers():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞–∂–¥—ã–π callback –∏–º–µ–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ—Ç "–º–µ—Ä—Ç–≤—ã—Ö" callback'–æ–≤
```

### 3. –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
```python
def test_navigation():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞–∂–¥—ã–π —ç–∫—Ä–∞–Ω –∏–º–µ–µ—Ç –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ—Ç "–º–µ—Ä—Ç–≤—ã—Ö" —Å–æ—Å—Ç–æ—è–Ω–∏–π
```

### 4. –¢–µ—Å—Ç –∫–ª—é—á–µ–≤—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤
```python
def test_critical_screens():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É —ç–∫—Ä–∞–Ω–∞ —Ç–∞—Ä–∏—Ñ–æ–≤
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –ø—Ä–æ—Ñ–∏–ª—è
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø—Ä–∏–º–µ—Ä–æ—á–Ω–æ–π
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç UI-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [ ] –í—Å–µ callback_data —É–Ω–∏–∫–∞–ª—å–Ω—ã
- [ ] –í—Å–µ callback'—ã –∏–º–µ—é—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- [ ] –í—Å–µ —ç–∫—Ä–∞–Ω—ã –∏–º–µ—é—Ç –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞
- [ ] –ù–µ—Ç "–º–µ—Ä—Ç–≤—ã—Ö" —Å–æ—Å—Ç–æ—è–Ω–∏–π
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∫–Ω–æ–ø–æ–∫
- [ ] –í—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ö–ª—é—á–µ–≤—ã–µ —ç–∫—Ä–∞–Ω—ã –¥–æ—Å—Ç—É–ø–Ω—ã
- [ ] –ù–∞–≤–∏–≥–∞—Ü–∏—è –ª–æ–≥–∏—á–Ω–∞ –∏ –ø–æ–Ω—è—Ç–Ω–∞

## üö® –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã UI

### –ö—Ä–∏—Ç–∏—á–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- Callback –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
- "–ú–µ—Ä—Ç–≤—ã–µ" —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–µ–∑ –≤–æ–∑–≤—Ä–∞—Ç–∞
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è callback_data
- –ö–Ω–æ–ø–∫–∏, –≤–µ–¥—É—â–∏–µ –≤ –Ω–∏–∫—É–¥–∞

### –í—ã—Å–æ–∫–æ (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
- –ù–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- –ù–µ–ª–æ–≥–∏—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ UI

### –°—Ä–µ–¥–Ω–µ (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏)
- –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ UI
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å UX

---

**–ü–æ–º–Ω–∏—Ç–µ:** UI-–ª–æ–≥–∏–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞. –õ—é–±–∞—è –ø–æ–ª–æ–º–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
